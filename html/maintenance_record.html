<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Maintenance Record â€” TRAMS DB</title>
<style>
:root{--bg:#0b1220;--panel:#0f172a;--ink:#e6f0ff;--muted:#9fb1c8;--brand:#22d3ee;--border:#22314d;--card:#121b2e}
*{box-sizing:border-box}body{margin:0;background:#0a0f1f;color:var(--ink);font:15px/1.55 system-ui}
.wrap{max-width:900px;margin:22px auto;padding:0 16px}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px}
label{display:block;margin:10px 0 6px;color:var(--muted)}
input,select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid var(--border);background:#0e1730;color:var(--ink)}
textarea{min-height:110px}
.btn{background:var(--brand);color:#001b22;border:none;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer}
.notice{margin-top:10px;padding:10px;border:1px solid var(--border);border-radius:10px;background:#10203a;color:#cde7ff}
.table{width:100%;border-collapse:collapse;margin-top:14px}
.table th,.table td{padding:8px;border-bottom:1px solid var(--border)}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;background:#0f172a;border-bottom:1px solid var(--border)}
.logo{font-weight:800}.logo b{color:var(--brand)}.nav{display:flex;gap:14px}.nav a{color:var(--muted)}
</style>
</head>
<body>
<header class="topbar">
  <a class="logo" href="?A=logged.html">ðŸš‹ <b>TRAMS</b> DB</a>
  <nav class="nav">
    <a href="?A=search_basic.html">Search</a>
    <a href="?A=logged.html">Dashboard</a>
  </nav>
</header>
<main class="wrap">
  <div class="card">
    <h1>Add Maintenance Record</h1>
    <label>Tram ID <input id="tramId" placeholder="e.g. 205"/></label>
    <label>Date <input id="date" type="date"/></label>
    <label>Task <input id="task" placeholder="e.g. Bogie bearing replacement"/></label>
    <label>Details <textarea id="details"></textarea></label>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button id="save" class="btn">Save Record</button>
      <button id="load" class="btn">Load Recent</button>
    </div>
    <div id="notice" class="notice" hidden></div>
    <table class="table" id="tbl" hidden>
      <thead><tr><th>Date</th><th>Task</th><th>Details</th></tr></thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</main>
<script>
const masterServer="http://localhost/tramsMNG";
const notice=document.getElementById("notice");
const tbl=document.getElementById("tbl"); const tbody=document.getElementById("tbody");
function show(msg,err=false){notice.hidden=false; notice.textContent=msg; notice.style.color=err?"#ffd0d0":"#eaffff";}
document.getElementById("save").onclick=async()=>{
  const Username=sessionStorage.getItem("username")||"Guest";
  const Token=sessionStorage.getItem("token")||"";
  if(!Token||Username==="Guest") return show("Please login first.",true);
  const Tram_ID=document.getElementById("tramId").value.trim();
  const DateStr=document.getElementById("date").value;
  const Task=document.getElementById("task").value.trim();
  const Details=document.getElementById("details").value.trim();
  if(!Tram_ID||!Task) return show("Tram ID and task are required.",true);
  try{
    // const res=await fetch(`${masterServer}/api/Maint_AddRecord.php`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({Username,Token,Tram_ID,Date:DateStr,Task,Details})});
    // const j=await res.json(); if(!res.ok) throw new Error(j?.error||res.statusText);
    show("Record saved (demo).");
  }catch(e){show("Failed: "+e.message,true);}
};
document.getElementById("load").onclick=async()=>{
  tbody.innerHTML=""; tbl.hidden=false;
  try{
    // const res=await fetch(`${masterServer}/api/Maint_GetRecent.php`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({Token:sessionStorage.getItem('token')})});
    // const rows=await res.json();
    const rows=[{date:'2024-06-01',task:'HV overhaul',details:'Phase 2 done'},{date:'2024-09-12',task:'Door ECU firmware',details:'R15'}];
    rows.forEach(r=>{const tr=document.createElement('tr'); tr.innerHTML=`<td>${r.date||''}</td><td>${r.task||''}</td><td>${r.details||''}</td>`; tbody.appendChild(tr);});
  }catch(e){show("Load failed: "+e.message,true);}
};
</script>
</body>
</html>
